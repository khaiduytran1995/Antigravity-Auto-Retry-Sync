# Puppeteer-Real-Browser Captcha Bypass Implementation

## Summary
Replaced Selenium-based captcha bypass with puppeteer-real-browser sidecar process for better stealth and anti-detection.

## Changes Made

### 1. Created Sidecar Script
**File**: [capture-sidecar.js](file:///D:/14012026Veo%20Automation%20Setup%201.2.1/$PLUGINSDIR/Filegocdeupdate/Veo%20Automation/resources/app/dist-electron/scripts/capture-sidecar.js)

A standalone Node.js process using puppeteer-real-browser that:
- Opens hidden Chrome browser with stealth settings
- Navigates to labs.google/fx to load grecaptcha
- Accepts commands via stdin:
  - `GET_TOKENS <count> [action]` - Generate captcha tokens
  - `RESTART_BROWSER` - Force restart browser
  - `SHUTDOWN` - Clean exit
- Returns JSON responses via stdout
- Supports VIDEO_GENERATION, IMAGE_GENERATION, FLOW_GENERATION actions

---

### 2. Replaced recaptchaService.js
**File**: [recaptchaService.js](file:///D:/14012026Veo%20Automation%20Setup%201.2.1/$PLUGINSDIR/Filegocdeupdate/Veo%20Automation/resources/app/dist-electron/services/recaptchaService.js)

Changed from Selenium browser pool to sidecar process manager:
- Spawns [capture-sidecar.js](file:///D:/14012026Veo%20Automation%20Setup%201.2.1/$PLUGINSDIR/Filegocdeupdate/Veo%20Automation/resources/app/dist-electron/scripts/capture-sidecar.js) as child process
- Communicates via stdin/stdout JSON
- Auto-starts browser on first token request
- Handles process lifecycle and restarts

**API remains the same** - existing code calling `recaptchaService.getToken()` will work without changes.

---

### 3. Added Dependency
**File**: [package.json](file:///D:/14012026Veo%20Automation%20Setup%201.2.1/$PLUGINSDIR/Filegocdeupdate/Veo%20Automation/resources/app/package.json)

Added `puppeteer-real-browser: ^1.2.11` and ran npm install.

---

## Testing Steps

1. **Start the application**
   ```
   cd "D:\14012026Veo Automation Setup 1.2.1\$PLUGINSDIR\Filegocdeupdate\Veo Automation"
   .\Veo Automation.exe
   ```

2. **Login with Google account**

3. **Test image generation** - Check console for:
   ```
   [SidecarManager] âœ… Browser ready!
   [SidecarManager] Getting token for action: IMAGE_GENERATION
   ```

4. **Test video generation** - Check console for:
   ```
   [SidecarManager] Getting token for action: VIDEO_GENERATION
   ```

5. **Check for 403 errors** - If occurs, browser auto-restarts

## Key Advantages over Selenium

| Feature | Selenium (old) | Puppeteer-Real-Browser (new) |
|---------|---------------|------------------------------|
| Detection | Easily detected | Hard to detect (turnstile bypass) |
| Stealth | Limited | Built-in anti-detection |
| Browser | Headless only | Real browser with hidden window |
| Performance | New browser per request | Persistent browser |
