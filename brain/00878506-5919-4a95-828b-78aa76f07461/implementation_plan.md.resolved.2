# Puppeteer-Real-Browser Captcha Bypass Integration

## Goal
Replace Selenium-based recaptchaService with puppeteer-real-browser sidecar process for better stealth and anti-detection.

## Current State
- App uses [recaptchaService.js](file:///D:/14012026Veo%20Automation%20Setup%201.2.1/$PLUGINSDIR/Filegocdeupdate/Veo%20Automation/resources/app/dist-electron/services/recaptchaService.js) with Selenium WebDriver in headless mode
- Selenium is detectable and often gets 403 errors
- Need to replace with more stealthy puppeteer-real-browser approach

## Proposed Changes

### 1. Create Sidecar Script
#### [NEW] [capture-sidecar.js](file:///D:/14012026Veo%20Automation%20Setup%201.2.1/$PLUGINSDIR/Filegocdeupdate/Veo%20Automation/resources/app/dist-electron/scripts/capture-sidecar.js)
Place in `dist-electron/scripts/`

Copy the user's provided script with minor adaptations:
- Support both VIDEO_GENERATION and IMAGE_GENERATION actions
- Add IPC communication via stdin/stdout
- Persistent browser instance

---

### 2. Modify recaptchaService.js
#### [MODIFY] [recaptchaService.js](file:///D:/14012026Veo%20Automation%20Setup%201.2.1/$PLUGINSDIR/Filegocdeupdate/Veo%20Automation/resources/app/dist-electron/services/recaptchaService.js)

[COMPLETED] Replaced Selenium pool with sidecar process manager.

---

### 3. Refactor Generation Services
#### [MODIFY] [flowVideo.js](file:///D:/14012026Veo%20Automation%20Setup%201.2.1/$PLUGINSDIR/Filegocdeupdate/Veo%20Automation/resources/app/dist-electron/services/flowVideo.js)
#### [MODIFY] [flowImage.js](file:///D:/14012026Veo%20Automation%20Setup%201.2.1/$PLUGINSDIR/Filegocdeupdate/Veo%20Automation/resources/app/dist-electron/services/flowImage.js)

**Changes:**
- Replace `tokenManager.mimicApiCall` with direct `axios` requests (matching v2.3.3)
- Remove reliance on `SECRET_CONFIG` for endpoints; use hardcoded Google API endpoints from v2.3.3
- Simplify project structure and context to match v2.3.3
- Ensure reCAPTCHA tokens are fetched from the new `recaptchaService`
- Improve error logging and recovery

---

### 4. Update Dependencies
[COMPLETED] Added `puppeteer-real-browser` to package.json.

---

## Verification Plan
1. Start app and check if sidecar spawns successfully
2. Login with Google account
3. Generate image → check if token works
4. Generate video → check if token works
5. Monitor console for 403 errors
