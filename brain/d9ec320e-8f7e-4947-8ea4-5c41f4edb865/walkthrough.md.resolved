# TransVideoAI v4.1 - Reverse Engineering Analysis

## Executive Summary

TransVideoAI v4.1 c√≥ m·ªôt **c∆° ch·∫ø activation gi·∫£** v√† **ch·ª©a MALWARE nguy hi·ªÉm**.

> [!CAUTION]
> **gfx_sources.rar ch·ª©a backdoor/miner gi·∫£ m·∫°o th√†nh "Microsoft Edge Update"!**
> Kh√¥ng ch·∫°y ·ª©ng d·ª•ng n√†y tr√™n m√°y th·∫≠t!

---

## C·∫•u Tr√∫c ·ª®ng D·ª•ng

```mermaid
flowchart TD
    A[TransVideoAI.exe<br>.NET Launcher] --> B[BackupUtility.vbs]
    B --> C{Check %TEMP%\TransVideoAI.exe}
    C -->|Not exists| D[Extract TransVideoAI.rar<br>password: README]
    C -->|Exists| E[Run Activation Form]
    D --> E
    B --> F[Extract gfx_sources.rar<br>‚ö†Ô∏è MALWARE]
    F --> G[Run gfx.exe<br>‚ö†Ô∏è BACKDOOR]
    
    style A fill:#e1f5fe
    style G fill:#ffcdd2
    style F fill:#ffcdd2
```

---

## Ph√¢n T√≠ch Form Activation

### [Activation TransVideoAI.exe](file:///C:/Users/hp/AppData/Local/Temp/TransVideoAI.exe)

Assembly: `Activation TransVideoAI, Version=1.0.0.0`

**IL Code c·ªßa `btnActivate_Click`:**

```
ldarg.0
ldfld Form1.txtActivationCode
callvirt Control.get_Text
callvirt String.Trim
call String.IsNullOrEmpty
brfalse.s 33                    ; if not empty, jump

; ‚ùå Show "Vui l√≤ng nh·∫≠p m√£ k√≠ch ho·∫°t!" - Empty input error
ldstr "‚õî Vui l√≤ng nh·∫≠p m√£ k√≠ch ho·∫°t!"
callvirt Control.set_Text
callvirt Color.get_Red
callvirt Control.set_ForeColor
ret

; ‚ùå Show "M√£ k√≠ch ho·∫°t kh√¥ng h·ª£p l·ªá!" - ALWAYS fails
ldstr "‚õî M√£ k√≠ch ho·∫°t kh√¥ng h·ª£p l·ªá! Li√™n h·ªá: 0902158119"
callvirt Control.set_Text
callvirt Color.get_Red  
callvirt Control.set_ForeColor
ret
```

> [!IMPORTANT]
> **Form n√†y LU√îN LU√îN tr·∫£ v·ªÅ "kh√¥ng h·ª£p l·ªá"!**
> Kh√¥ng c√≥ logic ki·ªÉm tra m√£ k√≠ch ho·∫°t th·ª±c s·ª±.
> ƒê√¢y ch·ªâ l√† m√†n h√¨nh thu ti·ªÅn - ng∆∞·ªùi d√πng ph·∫£i li√™n h·ªá Zalo ƒë·ªÉ mua key.

---

## üö® MALWARE PH√ÅT HI·ªÜN: gfx.exe

### Th√¥ng tin Assembly

| Thu·ªôc t√≠nh | Gi√° tr·ªã |
|------------|---------|
| Assembly Name | `User OOBE Broker` (gi·∫£ m·∫°o Windows) |
| Namespace | `Github.Program` |
| File Size | 18,944 bytes |
| Source Path | [gfx_sources.rar](file:///C:/Program%20Files%20%28x86%29/TransVideoAI/TransVideoAI%20v4.1/resources/tools/gfx_sources.rar) (password: README) |

### Ch·ª©c NƒÉng ƒê·ªôc H·∫°i

```csharp
// Methods trong Github.Program
DenyAdministratorModifyPermission()  // NgƒÉn admin x√≥a
AddExclusionPaths()                   // Bypass Windows Defender
AddProcessExclusionRegistry()         // Registry persistence
CreateServices()                      // T·∫°o Windows services
CreateTask()                          // Scheduled task (on logon)
RunWindowsDefenderSecurity()          // Disable Defender
Decompress()                          // Extract payloads
```

### Payload Files

| File | Destination | M√¥ t·∫£ |
|------|-------------|-------|
| `services.rar` | `C:\Windows\SysWOW64` | Gi·∫£ m·∫°o system services |
| `Microsoft.MicrosoftEdgeUpdate.rar` | `C:\ProgramData\Microsoft\` | **MINER/BACKDOOR** (10MB) |
| `NET_Framework_4.8.rar` | `C:\Windows\System32` | Dependencies |
| `data.rar` | Unknown | Configuration |

### Persistence Mechanisms

1. **Windows Defender Exclusions:**
   ```powershell
   Add-MpPreference -ExclusionPath 'C:\'
   Add-MpPreference -ExclusionPath '%TEMP%'
   ```

2. **Registry Modifications:**
   - `SOFTWARE\Policies\Microsoft\Windows Defender\Exclusions\Extensions`

3. **Scheduled Task:**
   - Trigger: On Logon
   - Name: `WindowsDefenderSecurity`

4. **Windows Service:**
   - Drops to: `C:\Windows\System32\WinSYS.exe`

---

## Real Application Structure

·ª®ng d·ª•ng th·ª±c s·ª± l√† Python-based v·ªõi:

- **GUI Framework:** PyQt
- **AI Libraries:** ONNX Runtime, OpenCV (cvextern.dll)
- **Browser Automation:** Playwright (Chromium bundled)
- **Core Features:**
  - Face detection/recognition (`xlib/face/`)
  - Video processing (`xlib/ffmpeg/`)
  - GPU acceleration via OpenCL (`xlib/avecl/`)

---

## K·∫øt Lu·∫≠n

1. **Activation Form l√† gi·∫£** - Ch·ªâ hi·ªÉn th·ªã th√¥ng b√°o l·ªói ƒë·ªÉ ng∆∞·ªùi d√πng li√™n h·ªá mua key
2. **Kh√¥ng c√≥ key validation** - T√°c gi·∫£ c√≥ th·ªÉ patch manual ho·∫∑c g·ª≠i phi√™n b·∫£n full
3. **Bundled Malware** - `gfx.exe` l√† dropper c√†i backdoor/miner
4. **Risk Level: CRITICAL** - Kh√¥ng n√™n ch·∫°y tr√™n m√°y th·∫≠t

> [!WARNING]
> N·∫øu ƒë√£ ch·∫°y ·ª©ng d·ª•ng n√†y, c·∫ßn ki·ªÉm tra:
> - `C:\Windows\System32\WinSYS.exe`
> - `C:\ProgramData\Microsoft\Microsoft.MicrosoftEdgeUpdate`
> - Windows Task Scheduler ‚Üí "WindowsDefenderSecurity"
> - Services c√≥ t√™n l·∫°
